<!DOCTYPE html>
<html>

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="renderer" content="webkit">

    <title>考试成绩评估分析系统</title>
    <meta name="keywords" content="">
    <meta name="description" content="">

    <link href="css/bootstrap.min.css?v=3.4.0" rel="stylesheet">
    <link href="font-awesome/css/font-awesome.css?v=4.3.0" rel="stylesheet">

    <!-- Data Tables -->
    <link href="css/plugins/dataTables/dataTables.bootstrap.css" rel="stylesheet">

    <link href="css/animate.css" rel="stylesheet">
    <link href="css/style.css?v=2.2.0" rel="stylesheet">

</head>

<body>
    <div id="wrapper">
        <nav class="navbar-default navbar-static-side" role="navigation">
            <div class="sidebar-collapse">
                <ul class="nav" id="side-menu">
                    <li class="nav-header">

                        <div class="dropdown profile-element"> <span>
                            <img alt="image" class="img-circle img-responsive" src="img/Emblem1.png" />
                             </span>
                            <a data-toggle="dropdown" class="dropdown-toggle" href="index.html#">
                                <span class="clear hidden"> <span class="block m-t-xs"> <strong class="font-bold" id="user_name">${userName}</strong>
                             </span>  <span class="text-muted text-xs block">+ <b class="caret"></b></span> </span>
                            </a>
                            <ul class="dropdown-menu animated fadeInRight m-t-xs">
                                <li><a href="profile.html">个人资料</a>
                                </li>
                                <li class="divider"></li>
                                <li><a href="login.html">安全退出</a>
                                </li>
                            </ul>
                        </div>
                        <div class="logo-element">
                            H+
                        </div>

                    </li>
                    <li>
                        <a href="index.html"><i class="fa fa-th-large"></i> <span class="nav-label">课程管理</span> <span class="fa arrow"></span></a>
                        <ul class="nav nav-second-level">
                            <li><a href="course_viewall.html">查看所有课程</a>
                            </li>
                            <li><a href="course_create.html">增加课程</a>
                            </li>
                            <li><a href="course_delete.html">删除课程</a>
                            </li>
                            <li><a href="course_modify.html">修改课程</a>
                            </li>
                            <li><a href="course_query.html">查询课程</a>
                            </li>
                        </ul>
                    </li>
                    
                    <li>
                      <a href="index.html"><i class="fa fa-th-large"></i> <span class="nav-label">老师管理</span> <span class="fa arrow"></span></a>
                      <ul class="nav nav-second-level">
                        <li><a href="teacher_viewall.html">查看所有老师</a>
                        </li>
                        <li><a href="teacher_create.html">增加老师</a>
                        </li>
                        <li><a href="teacher_delete.html">删除老师</a>
                        </li>
                        <li><a href="teacher_modify.html">修改老师</a>
                        </li>
                        <li><a href="teacher_query.html">查看老师</a>
                        </li>
                        </ul>
                    </li>

                    <li>
                      <a href="index.html"><i class="fa fa-th-large"></i> <span class="nav-label">学生管理</span> <span class="fa arrow"></span></a>
                      <ul class="nav nav-second-level">
                        <li><a href="student_viewall.html">查看所有学生</a>
                        </li>
                        <li><a href="student_create.html">增加学生</a>
                        </li>
                        <li><a href="student_delete.html">删除学生</a>
                        </li>
                        <li><a href="student_modify.html">修改学生</a>
                        </li>
                        <li><a href="student_query.html">查看学生</a>
                        </li>
                        </ul>
                    </li>

                    <li class="active">
                      <a href="index.html"><i class="fa fa-th-large"></i> <span class="nav-label">试卷管理</span> <span class="fa arrow"></span></a>
                      <ul class="nav nav-second-level">
                        <li><a href="paper_viewall.html">查看所有试卷</a>
                        </li>
                        <li><a href="paper_create.html">创建试卷</a>
                        </li>
                        <li><a href="paper_delete.html">删除试卷</a>
                        </li>
                        <li class="active"><a href="paper_modify.html">修改试卷</a>
                        </li>
                        <li><a href="paper_query.html">查看试卷</a>
                        </li>
                        </ul>
                    </li>

                    <li>
                      <a href="index.html"><i class="fa fa-th-large"></i> <span class="nav-label">成绩分析</span> <span class="fa arrow"></span></a>
                      <ul class="nav nav-second-level">
                        <li><a href="score_viewall.html">查看所有成绩</a>
                        </li>
                        <li><a href="score_create.html">上传成绩</a>
                        </li>
                        <li><a href="score_delete.html">删除成绩</a>
                        </li>
                        <li><a href="score_modify.html">修改成绩</a>
                        </li>
                        <li><a href="score_query.html">查询成绩</a>
                        </li>
                        <li><a href="score_analysis.html">成绩分析</a>
                        </li>
                      </ul>
                    </li>

                </ul>

            </div>
        </nav>

        <div id="page-wrapper" class="gray-bg dashbard-1">
            <div class="row border-bottom">
                <nav class="navbar navbar-static-top" role="navigation" style="margin-bottom: 0">

                    <ul class="nav navbar-top-links navbar-right">
                        <li>
                            <span class="m-r-sm text-muted welcome-message"><a href="index.html" title="返回首页"><i class="fa fa-home"></i></a>欢迎使用</span>
                        </li>

                        <li>
                            <a href="login.html">
                                <i class="fa fa-sign-out"></i> 退出
                            </a>
                        </li>
                    </ul>

                </nav>
            </div>
            <div class="row wrapper border-bottom white-bg page-heading">
                <div class="col-lg-10">
                    <h2>修改试卷</h2>
                    <ol class="breadcrumb">
                        <li>
                            <a href="index.html">考试成绩评估分析系统</a>
                        </li>
                        <li>
                            <a>试卷管理</a>
                        </li>
                        <li>
                            <strong>修改试卷</strong>
                        </li>
                    </ol>
                </div>
                <div class="col-lg-2">
                </div>
            </div>
            <div class="wrapper wrapper-content animated fadeInRight">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="ibox float-e-margins">
                            <div class="ibox-title">
                                <h5>试卷数据 <small>浏览</small></h5>
                                <div class="ibox-tools">
                                    <a class="collapse-link">
                                        <i class="fa fa-chevron-up"></i>
                                    </a>
                                    <a class="dropdown-toggle" data-toggle="dropdown" href="table_data_tables.html#">
                                        <i class="fa fa-wrench"></i>
                                    </a>
                                    <a class="close-link">
                                        <i class="fa fa-times"></i>
                                    </a>
                                </div>
                            </div>
                            <div class="ibox-content">
                                <table class="table table-striped table-bordered table-hover dataTables-example">
                                    <thead>
                                        <tr>

                                        </tr>
                                    </thead>
                                    <tbody>

                                    </tbody>
                                </table>

                            </div>

                            <div class="modal inmodal" id="myModal-modify" tabindex="-1" role="dialog" aria-hidden="true">
                                <div class="modal-dialog">
                                    <div class="modal-content animated fadeIn">
                                        <div class="modal-header">
                                            <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                                            <h4 class="modal-title">试卷修改</h4>
                                        </div>
                                        <div class="modal-body">
                                          <div class="row">
                                            <div class="col-sm-10">
                                              <p>请确认以下内容</p>
                                              <div class="form-group">
                                                <label>序号</label>
                                                <input type="text" class="form-control" id="modify-id" readonly="readonly">
                                              </div>
                                              <div class="form-group">
                                                <label>试卷名字</label>
                                                <input type="text" class="form-control" id="modify-name">
                                              </div>
                                              <div class="form-group">
                                                <label>试卷描述</label>
                                                <input type="text" class="form-control" id="modify-desc">
                                              </div>
                                              <div class="form-group">
                                                <label>课程</label>
                                                <input type="text" class="form-control" id="modify-course-id" readonly="readonly">
                                              </div>
                                            </div>
                                          </div>
                                        </div>
                                        <div class="modal-footer">
                                          <button type="button" class="btn btn-white" data-dismiss="modal">关闭</button>
                                          <button type="button" class="btn btn-primary" onclick="modify_submit()">保存</button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="modal inmodal fade" id="myModal-result" tabindex="-1" role="dialog"  aria-hidden="true">
                              <div class="modal-dialog modal-sm">
                                <div class="modal-content">
                                  <div class="modal-header">
                                    <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                                    <h4 class="modal-title">修改课程</h4>
                                  </div>
                                  <div class="modal-body">
                                    <p id="myModal-result-p">失败</p>
                                  </div>
                                  <div class="modal-footer">
                                    <button type="button" class="btn btn-primary" data-dismiss="modal">关闭</button>
                                  </div>
                                </div>
                              </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
            <div class="footer">
                <div class="pull-right">
                </div>
                <div>
                </div>
            </div>

        </div>
    </div>

    <!-- Mainly scripts -->
    <script src="js/jquery-2.1.1.min.js"></script>
    <script src="js/bootstrap.min.js?v=3.4.0"></script>
    <script src="js/plugins/metisMenu/jquery.metisMenu.js"></script>
    <script src="js/plugins/slimscroll/jquery.slimscroll.min.js"></script>

    <script src="js/plugins/jeditable/jquery.jeditable.js"></script>

    <!-- Data Tables -->
    <script src="js/plugins/dataTables/jquery.dataTables.js"></script>
    <script src="js/plugins/dataTables/dataTables.bootstrap.js"></script>

    <!-- Custom and plugin javascript -->
    <script src="js/hplus.js?v=2.2.0"></script>
    <script src="js/plugins/pace/pace.min.js"></script>

    <!-- Page-Level Scripts -->
    <script>

     $(document).ready(function () {

       $.ajax({
         type: "post",
         url: "api/json.do",
         dataType: "text",

         data: {
           func: "paper",
           param1: "viewall"
         },
         timeout: 50000,

         success: function (data) {
           //alert(data);
           var json = eval("("+data+")");

           var table = $(".ibox-content").children("table");
           var table0 = table.eq(0);
           /* thead */
           var thead = table0.children("thead");
           var thead_tr = thead.children("tr");

           var thead_tr_html = "<th class=\"check-header hidden-xs\"></th>";
           $.each(json.detailTHead, function(i, item) {
             thead_tr_html += "<th>" + item + "</th>";
           });
           thead_tr.html(thead_tr_html);

           /* tbody */
           var tbody = table0.children("tbody");
           var tbody_html = "";
           $.each(json.items, function(i, item) {
             tbody_html += "<tr class=\"gradeX\">";
             tbody_html += "<td> <button class=\"btn btn-xs\" data-toggle=\"modal\" data-target=\"#modifyForm\" onclick=\"modify_item(this)\">修改</button> </td>";
             $.each(json.thead, function(i, thead_item) {
               tbody_html += "<td>" + item[thead_item] + "</td>"
             });
             tbody_html += "</tr>";
           });
           tbody.html(tbody_html);
         },
         error: function() {
           alert("网络异常，请稍后重试");
         }
       });
     });

     function modify_submit()
     {
       var obj = {
         id: $("#modify-id").val(),
         name: $("#modify-name").val(),
         desc: $("#modify-desc").val(),
         course_id: $("#modify-course-id").val()
       }

       /* do modify */
       $.ajax({
         type: "post",
         url: "api/json.do",
         dataType: "text",

         data: {
           func: "paper",
           param1: "modify",
           param2: JSON.stringify(obj)
         },
         timeout: 50000,

         success: function (data) {
           var json = eval("("+data+")");
           $("#myModal-result-p").text(json.result);
           $('#myModal-result').modal('show');
           $(function() {
             $('#myModal-result').on('hide.bs.modal',
                                     function() {
                                       window.location.reload(true);
                                     });
           });
         },
         error: function() {
           alert("网络异常，请稍后重试");
         }
       });
     }

     function modify_item(obj)
     {
       var id = obj.parentNode.parentNode.cells[1].textContent;
       var name = obj.parentNode.parentNode.cells[2].textContent;
       var desc = obj.parentNode.parentNode.cells[3].textContent;
       var course_id = obj.parentNode.parentNode.cells[4].textContent;

       $("#modify-id").val(id);
       $("#modify-name").val(name);
       $("#modify-desc").val(desc);
       $("#modify-course-id").val(course_id);
       $('#myModal-modify').modal('show');
       return;
     }

    </script>

</body>

</html>
